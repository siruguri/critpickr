# coding: utf-8
def valid_long_tmdb_response
  '{"page":1,"results":[{"adult":false,"backdrop_path":"/kvXLZqY0Ngl1XSw7EaMQO0C1CCj.jpg","genre_ids":[28,12,878],"id":102899,"original_language":"en","original_title":"Ant-Man","overview":"Armed with the astonishing ability to shrink in scale but increase in strength, con-man Scott Lang must embrace his inner-hero and help his mentor, Dr. Hank Pym, protect the secret behind his spectacular Ant-Man suit from a new generation of towering threats. Against seemingly insurmountable obstacles, Pym and Lang must plan and pull off a heist that will save the world.","release_date":"2015-07-17","poster_path":"/7SGGUiTE6oc2fh9MjIk5M00dsQd.jpg","popularity":49.886069,"title":"Ant-Man","video":false,"vote_average":7.1,"vote_count":785},{"adult":false,"backdrop_path":"/ZQixhAZx6fH1VNafFXsqa1B8QI.jpg","genre_ids":[28,878,12],"id":1726,"original_language":"en","original_title":"Iron Man","overview":"Tony Stark. Genius, billionaire, playboy, philanthropist. Son of legendary inventor and weapons contractor Howard Stark. When Tony Stark is assigned to give a weapons presentation to an Iraqi unit led by Lt. Col. James Rhodes, he\'s given a ride on enemy lines. That ride ends badly when Stark\'s Humvee that he\'s riding in is attacked by enemy combatants. He survives - barely - with a chest full of shrapnel and a car battery attached to his heart. In order to survive he comes up with a way to miniaturize the battery and figures out that the battery can power something else. Thus Iron Man is born. He uses the primitive device to escape from the cave in Iraq. Once back home, he then begins work on perfecting the Iron Man suit. But the man who was put in charge of Stark Industries has plans of his own to take over Tony\'s technology for other matters.","release_date":"2008-05-02","poster_path":"/848chlIWVT41VtAAgyh9bWymAYb.jpg","popularity":5.744332,"title":"Iron Man","video":false,"vote_average":7.1,"vote_count":4571},{"adult":false,"backdrop_path":"/n9X2DKItL3V0yq1q1jrk8z5UAki.jpg","genre_ids":[28,12,878],"id":68721,"original_language":"en","original_title":"Iron Man 3","overview":"The brash-but-brilliant industrialist Tony Stark faces an enemy whose reach knows no bounds. When Stark finds his personal world destroyed at his enemy’s hands, he embarks on a harrowing quest to find those responsible. This journey, at every turn, will test his mettle. With his back against the wall, Stark is left to survive by his own devices, relying on his ingenuity and instincts to protect those closest to him. As he fights his way back, Stark discovers the answer to the question that has secretly haunted him: does the man make the suit or does the suit make the man?","release_date":"2013-05-03","poster_path":"/1Ilv6ryHUv6rt9zIsbSEJUmmbEi.jpg","popularity":6.815624,"title":"Iron Man 3","video":false,"vote_average":6.8,"vote_count":5651},{"adult":false,"backdrop_path":"/hSvpWAVXC781u5rOgI44799p2WL.jpg","genre_ids":[80,28,53],"id":254904,"original_language":"en","original_title":"The November Man","overview":"An ex- CIA operative is brought back in on a very personal mission and finds himself pitted against his former pupil in a deadly game involving high level CIA officials and the Russian president-elect.","release_date":"2014-08-27","poster_path":"/lcg1bkriMVvc8m0jz5zk0yvzVTA.jpg","popularity":6.478657,"title":"The November Man","video":false,"vote_average":6.1,"vote_count":296},{"adult":false,"backdrop_path":"/jz6NCADCgj4dWU8RM81Xvrokey4.jpg","genre_ids":[14,28],"id":557,"original_language":"en","original_title":"Spider-Man","overview":"After being bitten by a genetically altered spider, nerdy high school student Peter Parker is endowed with amazing powers.","release_date":"2002-05-02","poster_path":"/rZd0y1X1Gw4t5B3f01Qzj8DYY66.jpg","popularity":3.700802,"title":"Spider-Man","video":false,"vote_average":6.4,"vote_count":1945},{"adult":false,"backdrop_path":"/jxdSxqAFrdioKgXwgTs5Qfbazjq.jpg","genre_ids":[28,12,878],"id":10138,"original_language":"en","original_title":"Iron Man 2","overview":"With the world now aware of his dual life as the armored superhero Iron Man, billionaire inventor Tony Stark faces pressure from the government, the press, and the public to share his technology with the military. Unwilling to let go of his invention, Stark, along with Pepper Potts, and James \"Rhodey\" Rhodes at his side, must forge new alliances - and confront powerful enemies.","release_date":"2010-05-07","poster_path":"/ArqpkNYGfcTIA6umWt6xihfIZZv.jpg","popularity":4.789376,"title":"Iron Man 2","video":false,"vote_average":6.6,"vote_count":3768},{"adult":false,"backdrop_path":"/p3cQ5OTgxiBXvL1LtunxU8L3yO4.jpg","genre_ids":[35],"id":146239,"original_language":"en","original_title":"Delivery Man","overview":"An affable underachiever finds out he\'s fathered 533 children through anonymous donations to a fertility clinic 20 years ago. Now he must decide whether or not to come forward when 142 of them file a lawsuit to reveal his identity.","release_date":"2013-11-22","poster_path":"/XFNn7rL7JoG9eW0OoW8WU2wB4y.jpg","popularity":3.176292,"title":"Delivery Man","video":false,"vote_average":6.0,"vote_count":223},{"adult":false,"backdrop_path":"/6sLQFh6VFxU8nIkVaYg2yyJ6FL.jpg","genre_ids":[80,18,53],"id":388,"original_language":"en","original_title":"Inside Man","overview":"An efficient gang enters a Manhattan bank, locks the doors, and takes hostages. They work deliberately, without haste. Detective Frazier is assigned to negotiate, but his mind is occupied with the corruption charges he is facing. With an army of police surrounding the bank, the thief, the cop, and the plutocrat\'s fixer enter high-stakes negotiations. Why are the robbers asking for a plane, if they are so competent and they know they won\'t get one? Why aren\'t they in more of a hurry?","release_date":"2006-03-24","poster_path":"/z6wYRuvk1lf60R4SmWETfdUvGsm.jpg","popularity":3.026717,"title":"Inside Man","video":false,"vote_average":6.9,"vote_count":479},{"adult":false,"backdrop_path":"/nA7a6uJkrkNEa77043GThE7BgPu.jpg","genre_ids":[35,10749],"id":10201,"original_language":"en","original_title":"Yes Man","overview":"Carl Allen has stumbled across a way to shake free of post-divorce blues and a dead-end job: embrace life and say yes to everything.","release_date":"2008-12-19","poster_path":"/zqSqnHb045TN8Lzt2X4IVy8dfAW.jpg","popularity":2.764006,"title":"Yes Man","video":false,"vote_average":6.3,"vote_count":523},{"adult":false,"backdrop_path":"/jYLh4mdOqkt30i7LTFs3o02UcGF.jpg","genre_ids":[28,12,14,878],"id":49521,"original_language":"en","original_title":"Man of Steel","overview":"A young boy learns that he has extraordinary powers and is not of this earth. As a young man, he journeys to discover where he came from and what he was sent here to do. But the hero in him must emerge if he is to save the world from annihilation and become the symbol of hope for all mankind.","release_date":"2013-06-14","poster_path":"/xWlaTLnD8NJMTT9PGOD9z5re1SL.jpg","popularity":4.549312,"title":"Man of Steel","video":false,"vote_average":6.5,"vote_count":3564},{"adult":false,"backdrop_path":"/qpMYSLIpBlH41VqJaY79fNHGx1p.jpg","genre_ids":[18],"id":380,"original_language":"en","original_title":"Rain Man","overview":"Selfish yuppie Charlie Babbitt\'s father left a fortune to his savant brother Raymond and a pittance to Charlie; they travel cross-country.","release_date":"1988-12-11","poster_path":"/vllKYkA7eYi2UMM9yWQ1JegefBh.jpg","popularity":1.649149,"title":"Rain Man","video":false,"vote_average":7.2,"vote_count":532},{"adult":false,"backdrop_path":"/fj6nbVd7FVENNLtusyd1U8bcUFu.jpg","genre_ids":[28,12,35,878],"id":9739,"original_language":"en","original_title":"Demolition Man","overview":"Simon Phoenix, a violent criminal cryogenically frozen in 1996, has escaped during a parole hearing in 2032 in the utopia of San Angeles. Police are incapable of dealing with his violent ways and turn to his captor, John Spartan, who had also been cryogenically frozen when wrongfully accused of killing 30 innocent people while apprehending Phoenix.","release_date":"1993-10-06","poster_path":"/k0PN3Ho12cGGIVJW7SCS7apLYaP.jpg","popularity":1.433107,"title":"Demolition Man","video":false,"vote_average":6.1,"vote_count":374},{"adult":false,"backdrop_path":null,"genre_ids":[],"id":267705,"original_language":"en","original_title":"Man","overview":"An animation short film looking at mans relationship with the natural world","release_date":"2012-08-23","poster_path":"/cDL6CUxDe8D4sF7vzd03dzKJoNN.jpg","popularity":1.003068,"title":"Man","video":false,"vote_average":10.0,"vote_count":2},{"adult":false,"backdrop_path":"/4ZMFxj9FR13Q6PP6N8YBPhMnN4Q.jpg","genre_ids":[28,878,53],"id":9383,"original_language":"en","original_title":"Hollow Man","overview":"Cocky researcher Sebastian Caine is working on a project to make living creatures invisible. He\'s so confident he\'s found the right formula that he tests it on himself and soon begins to vanish. The only problem is, no one can figure out how to make him visible again. This predicament begins to drive Caine mad, with terrifying results.","release_date":"2000-08-04","poster_path":"/ubc2Nf3fJirAUcxVLUismTSo4XD.jpg","popularity":1.205623,"title":"Hollow Man","video":false,"vote_average":5.4,"vote_count":164},{"adult":false,"backdrop_path":"/k3ccsowPEK40pWrTuvybSZDqPKN.jpg","genre_ids":[878],"id":2277,"original_language":"en","original_title":"Bicentennial Man","overview":"In the not so distant future, androids are owned as household servants. Andrew, is an extraordinary robot who exhibits emotional and creative characteristics that were never expected of him. Over a period of 200 years he evolves far beyond his initial design.","release_date":"1999-12-17","poster_path":"/pt57Kwkd2g2xdYFZKx3yCoz9Xim.jpg","popularity":2.194873,"title":"Bicentennial Man","video":false,"vote_average":6.4,"vote_count":210},{"adult":false,"backdrop_path":"/jzyUa3g23LB4Yd9FFGzcomdyG29.jpg","genre_ids":[35,18,10751,10749],"id":9655,"original_language":"en","original_title":"She\'s the Man","overview":"Viola Johnson is in a real jam. Complications threaten her scheme to pose as her twin brother, Sebastian, and take his place at a new boarding school. She falls in love with her handsome roommate, Duke, who loves beautiful Olivia, who has fallen for Sebastian! As if that were not enough, Viola\'s twin returns from London ahead of schedule but has no idea that his sister has already replaced him on campus.","release_date":"2006-03-17","poster_path":"/aoO3OtAojt9g8D60tro8s26mGmj.jpg","popularity":2.911264,"title":"She\'s the Man","video":false,"vote_average":6.4,"vote_count":186},{"adult":false,"backdrop_path":"/A0bFdUMtd4mcXMRou7alzk6HQVZ.jpg","genre_ids":[35,28,12],"id":203801,"original_language":"en","original_title":"The Man from U.N.C.L.E.","overview":"In the early 1960s, CIA agent Napoleon Solo and KGB operative Illya Kuryakin participate in a joint mission against a mysterious criminal organization, which is working to proliferate nuclear weapons.","release_date":"2015-08-14","poster_path":"/5ttOaThDVmTpV8iragbrhdfxEep.jpg","popularity":4.8841,"title":"The Man from U.N.C.L.E.","video":false,"vote_average":3.2,"vote_count":21},{"adult":false,"backdrop_path":"/lcRGF2RpurdvBiSQVocfzRrxV9u.jpg","genre_ids":[18,28,36],"id":14756,"original_language":"cn","original_title":"葉問","overview":"A semi-biographical account of Yip Man, the first martial arts master to teach the Chinese martial art of Wing Chun. The film focuses on events surrounding Ip that took place in the city of Foshan between the 1930s to 1940s during the Second Sino-Japanese War. Directed by Wilson Yip, the film stars Donnie Yen in the lead role, and features fight choreography by Sammo Hung.","release_date":"2008-12-12","poster_path":"/8knFfuqW289DJi2cpPl4RVTDkbo.jpg","popularity":2.002076,"title":"Ip Man","video":false,"vote_average":7.3,"vote_count":623},{"adult":false,"backdrop_path":"/oeLeqa5yd0KV9ZghzC9qUqQ8z6l.jpg","genre_ids":[14,28,35,878,10751],"id":11244,"original_language":"en","original_title":"The Meteor Man","overview":"One night Jefferson Reed gets hit in the chest by a souped-up chunk of meteor. So he can fly, but he\'s scared of heights. He can master the information in any book ... for about fifteen minutes. Now his friends and family want him to protect their community from the dreaded Golden Lords.","release_date":"1993-08-06","poster_path":"/hEjSCLVv5w6YpKpFmlmFTUTybYO.jpg","popularity":1.330305,"title":"The Meteor Man","video":false,"vote_average":5.7,"vote_count":6},{"adult":false,"backdrop_path":null,"genre_ids":[28,18],"id":280388,"original_language":"en","original_title":"Hard Knocks","overview":"A suspenseful and romantic tale of a young man, Guy Montgomery (Michael Christian), whose whole life thus far has been a desperate escape from a tragic and dangerous past. Idealistic as he tries to be, a series of unfortunate incidents in the neon jungle of Hollywood lead him deeper and deeper into the mire of its seamier side until one terrifying evening at the home of a famous actress (Josette Banzet) Guy gets into a fight with her husband and beats him up so badly that he thinks he has killed the man. Once again, Guy is running from his past toward an uncertain future.","release_date":"1979-04-01","poster_path":"/dCBiFyrkZETxG4kvXcVWRwoeuvD.jpg","popularity":1.3,"title":"Hard Knocks","video":false,"vote_average":0.0,"vote_count":0}],"total_pages":272,"total_results":5437}'
end

def valid_stripe_charge_object
  {
    "id": "ch_16HMo32eZvKYlo2CN0EYDD5k",
   "object": "charge",
   "created": 1435186643,
   "livemode": false,
   "paid": true,
   "status": "succeeded",
   "amount": 5000,
   "currency": "usd",
   "refunded": false,
   "source": {
               "id": "card_16HMo02eZvKYlo2CfsizBfho",
              "object": "card",
              "last4": "4242",
              "brand": "Visa",
              "funding": "credit",
              "exp_month": 12,
              "exp_year": 2016,
              "country": "US",
              "name": "gbr_brad@hotmail.com",
              "address_line1": nil,
              "address_line2": nil,
              "address_city": nil,
              "address_state": nil,
              "address_zip": nil,
              "address_country": nil,
              "cvc_check": "pass",
              "address_line1_check": nil,
              "address_zip_check": nil,
              "dynamic_last4": nil,
              "metadata": {
                          },
              "customer": "cus_6ULVKZxppyINJm"
             },
   "captured": true,
   "balance_transaction": "txn_16Esmv2eZvKYlo2CXxibx5gw",
   "failure_message": nil,
   "failure_code": nil,
   "amount_refunded": 0,
   "customer": "cus_6ULVKZxppyINJm",
   "invoice": nil,
   "description": nil,
   "dispute": nil,
   "metadata": {
               },
   "statement_descriptor": nil,
   "fraud_details": {
                    },
   "receipt_email": nil,
   "receipt_number": nil,
   "shipping": nil,
   "destination": nil,
   "application_fee": nil,
   "refunds": {
                "object": "list",
               "total_count": 0,
               "has_more": false,
               "url": "/v1/charges/ch_16HMo32eZvKYlo2CN0EYDD5k/refunds",
               "data": [

                       ]
              }
  }.to_json
end

def stripe_headers
  {'Accept'=>'*/*; q=0.5, application/xml'}
end

def valid_small_tmdb_response
  {"page":1,"results":[{"adult":false,"backdrop_path":"/4j8WcrHfVtsM58w2mANtxwLWUvU.jpg","genre_ids":[12,35,14,10751],"id":11708,"original_language":"en","original_title":"Chitty Chitty Bang Bang","overview":"An eccentric professor invents wacky machinery, but can't seem to make ends meet. When he invents a revolutionary car, a foreign government becomes interested in it, and resorts to skulduggery to get their hands on it.","release_date":"1968-12-16","poster_path":"/m2z9NV6ZWXdWH6xdpF9yBJveEPa.jpg","popularity":0.416083,"title":"Chitty Chitty Bang Bang","video":false,"vote_average":6.4,"vote_count":54}],"total_pages":1,"total_results":1}.to_json
end

def set_net_stubs
  stub_request(:post, "https://api.stripe.com/v1/charges").
    with(:body => hash_including({"amount"=>/^[\.\d]+$/, "currency"=>"usd"}),
         headers: stripe_headers).
    to_return(:status => 200, :body => valid_stripe_charge_object)

  stub_request(:get, "http://api.themoviedb.org/3/search/movie").with(query: {query: 'chitty',
                                                                             api_key: Rails.application.secrets.tmdb_api_key},
                                                                      headers: {'Accept'=>'*/*'}).
    to_return(status: 200, body: valid_small_tmdb_response)

  stub_request(:get, "http://api.themoviedb.org/3/search/movie").with(query: {query: 'man',
                                                                             api_key: Rails.application.secrets.tmdb_api_key},
                                                                      headers: {'Accept'=>'*/*'}).
    to_return(status: 200, body: valid_long_tmdb_response)
end
